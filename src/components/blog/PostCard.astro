---
import { formatDate } from '../../utils/formatters';

interface Props {
  post: {
    id: number;
    title: string;
    slug: string;
    excerpt: string;
    featured_image?: string;
    published_at: Date;
    reading_time: number;
    author: {
      username: string;
      full_name?: string;
    };
    category?: {
      name: string;
      slug: string;
    };
  };
  featured?: boolean;
}

const { post, featured = false } = Astro.props;

// Default image if none provided
const imageUrl = post.featured_image || '/images/default-post.jpg';
---

<article class={`bg-white rounded-lg shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-1 hover:shadow-md ${featured ? 'lg:flex' : ''}`}>
  <a href={`/blog/${post.slug}`} class={`block ${featured ? 'lg:w-1/2' : ''}`} aria-label={post.title}>
    <div class="relative overflow-hidden aspect-video">
      <img 
        src={imageUrl} 
        alt={post.title} 
        class="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
        width="800"
        height="450"
        loading="lazy"
      />
      {post.category && (
        <span class="absolute top-4 left-4 bg-primary-600 text-white text-xs font-semibold px-3 py-1 rounded-full">
          {post.category.name}
        </span>
      )}
    </div>
  </a>
  
  <div class={`p-5 ${featured ? 'lg:w-1/2 lg:flex lg:flex-col lg:justify-center' : ''}`}>
    <div class="flex items-center text-sm text-gray-500 mb-2">
      <span>{formatDate(post.published_at)}</span>
      <span class="mx-2">â€¢</span>
      <span>{post.reading_time || 5} min read</span>
    </div>
    
    <h2 class="text-xl font-heading font-semibold mb-2 text-gray-800 leading-tight">
      <a href={`/blog/${post.slug}`} class="hover:text-primary-600 transition-colors duration-200">
        {post.title}
      </a>
    </h2>
    
    <p class="text-gray-600 line-clamp-3 mb-4">
      {post.excerpt}
    </p>
    
    <div class="flex items-center justify-between">
      <div class="flex items-center">
        <div class="w-8 h-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-600 mr-2">
          {post.author.full_name?.charAt(0) || post.author.username.charAt(0)}
        </div>
        <span class="text-sm text-gray-700">{post.author.full_name || post.author.username}</span>
      </div>
      
      <a href={`/blog/${post.slug}`} class="text-primary-600 text-sm font-medium hover:text-primary-700 transition-colors duration-200 flex items-center">
        Read more
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
        </svg>
      </a>
    </div>
  </div>
</article>